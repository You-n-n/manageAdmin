<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper
        PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
        "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.nynu.goule.mapper.LoginUserMapper">

    <select id="login" parameterType="java.util.Map" resultType="java.util.Map">
        select * from users where username=#{username}
    </select>

    <insert id="addUser" parameterType="java.util.Map">
        insert into users (
        username,
        password,
        account_name,
        telphone,
        <if test="mail != null and mail != ''">
            mail,
        </if>
        <if test="prsnIdNum != null and prsnIdNum != ''">
            prsnIdNum,
        </if>
        <if test="birthDay != null and birthDay != ''">
            birthDay,
        </if>
        addTime
        )
        VALUES (
        #{username},
        #{password},
        #{accountName},
        #{telPhone},
        <if test="mail != null and mail != ''">
            #{mail},
        </if>
        <if test="prsnIdNum != null and prsnIdNum != ''">
            #{prsnIdNum},
        </if>
        <if test="birthDay != null and birthDay != ''">
            #{birthDay},
        </if>
        #{addTime}
        )
    </insert>

    <select id="queryUsernameCount" parameterType="java.lang.String" resultType="java.util.Map">
        select username from users where
        username like concat('%',#{username},'%')
    </select>

    <select id="getAllUserInfo" resultType="java.util.Map">
        select id,username,account_name accountName,telphone,mail,prsnIdNum,birthDay,DATE_FORMAT(addTime,'%Y-%m-%d %H:%i:%s') addTime from users ORDER BY addTime desc
    </select>

    <select id="queryPhoneNum" resultType="java.lang.Integer" parameterType="java.util.Map">
        select count(*) from users where telphone = #{telPhone}
    </select>

    <select id="getUserIdByUserName" resultType="com.nynu.goule.pojo.LoginUser" parameterType="String">
        select id from users where username = #{mainAcctId}
    </select>
</mapper>
